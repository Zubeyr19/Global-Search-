@startuml Global Search System - Use Case Diagram (Actual Implementation)
!theme plain

left to right direction

' Actors
actor "Viewer/Operator\n(VIEWER, OPERATOR)" as Viewer #LightBlue
actor "Manager\n(MANAGER)" as Manager #LightGreen
actor "Tenant Admin\n(TENANT_ADMIN)" as TenantAdmin #Yellow
actor "Super Admin\n(SUPER_ADMIN)" as SuperAdmin #Orange
actor "System\n(Automated)" as System #LightGray

' System boundary
rectangle "Global Search System" {

    ' Authentication & Authorization
    package "Authentication" {
        usecase "Login with Credentials" as UC_Login
        usecase "Refresh JWT Token" as UC_Refresh
        usecase "Logout" as UC_Logout
        usecase "Get Current User Info" as UC_Me
    }

    ' Search Features
    package "Search & Discovery" {
        usecase "Global Search\n(Tenant-Scoped)" as UC_GlobalSearch
        usecase "Quick Search\n(Autocomplete)" as UC_QuickSearch
        usecase "Search by Entity Type\n(Companies, Locations, etc.)" as UC_EntitySearch
        usecase "Fuzzy Search" as UC_FuzzySearch
        usecase "Search with Synonyms" as UC_SynonymSearch
        usecase "Get Search Statistics" as UC_SearchStats
    }

    ' Admin Features
    package "Admin Operations" {
        usecase "Cross-Tenant Search\n(All Tenants)" as UC_AdminSearch
        usecase "Manage Users" as UC_ManageUsers
        usecase "View System Overview" as UC_SystemOverview
        usecase "View Tenant Statistics" as UC_TenantStats
    }

    ' Policy & Access Control
    package "Policy Management" {
        usecase "Manage Policies\n(Create, Update, Delete)" as UC_ManagePolicies
        usecase "View Policies by Role" as UC_ViewPolicies
    }

    ' Audit & Monitoring
    package "Audit & Compliance" {
        usecase "View Audit Logs" as UC_ViewAuditLogs
        usecase "Search Audit Logs" as UC_SearchAuditLogs
        usecase "View User Activity" as UC_UserActivity
        usecase "Track Login Attempts" as UC_LoginAttempts
    }

    ' Performance & Monitoring
    package "Performance Monitoring" {
        usecase "View Performance Metrics" as UC_ViewMetrics
        usecase "Monitor Cache Performance" as UC_CacheMetrics
        usecase "Track Query Execution Times" as UC_QueryMetrics
    }

    ' Data Synchronization
    package "Data Sync" {
        usecase "Sync MySQL to Elasticsearch" as UC_SyncElastic
        usecase "Manual Reindex All Entities" as UC_Reindex
        usecase "Get Sync Status" as UC_SyncStatus
    }

    ' Reporting (Disabled but exists)
    package "Reporting (Service Layer)" {
        usecase "Generate Reports" as UC_GenerateReport
        usecase "Export Search Results\n(CSV, PDF, Excel)" as UC_ExportResults
    }

    ' Dashboard (Disabled but exists)
    package "Dashboards (Service Layer)" {
        usecase "Create Dashboard" as UC_CreateDashboard
        usecase "View Dashboards" as UC_ViewDashboard
        usecase "Update Dashboard" as UC_UpdateDashboard
    }

    ' Real-time Notifications
    package "Real-time Features" {
        usecase "Receive WebSocket\nNotifications" as UC_WebSocket
        usecase "Get Search Completion\nNotifications" as UC_SearchNotify
    }
}

' Viewer/Operator relationships
Viewer --> UC_Login
Viewer --> UC_Refresh
Viewer --> UC_Logout
Viewer --> UC_Me
Viewer --> UC_GlobalSearch
Viewer --> UC_QuickSearch
Viewer --> UC_EntitySearch
Viewer --> UC_FuzzySearch
Viewer --> UC_SynonymSearch
Viewer --> UC_SearchStats
Viewer --> UC_ViewPolicies
Viewer --> UC_WebSocket
Viewer --> UC_SearchNotify

' Manager inherits from Viewer
Manager --|> Viewer
Manager --> UC_ViewAuditLogs
Manager --> UC_UserActivity
Manager --> UC_ViewMetrics

' Tenant Admin inherits from Manager
TenantAdmin --|> Manager
TenantAdmin --> UC_ManageUsers
TenantAdmin --> UC_ManagePolicies
TenantAdmin --> UC_SearchAuditLogs
TenantAdmin --> UC_TenantStats
TenantAdmin --> UC_GenerateReport
TenantAdmin --> UC_ExportResults
TenantAdmin --> UC_CreateDashboard
TenantAdmin --> UC_ViewDashboard
TenantAdmin --> UC_UpdateDashboard

' Super Admin inherits from Tenant Admin
SuperAdmin --|> TenantAdmin
SuperAdmin --> UC_AdminSearch
SuperAdmin --> UC_SystemOverview
SuperAdmin --> UC_SyncElastic
SuperAdmin --> UC_Reindex
SuperAdmin --> UC_SyncStatus
SuperAdmin --> UC_CacheMetrics
SuperAdmin --> UC_QueryMetrics

' System automated processes
System --> UC_SyncElastic
System --> UC_LoginAttempts
System --> UC_QueryMetrics

' Extensions and includes
UC_GlobalSearch ..> UC_FuzzySearch : <<extends>>
UC_GlobalSearch ..> UC_SynonymSearch : <<extends>>
UC_GlobalSearch .> UC_WebSocket : <<includes>>
UC_GlobalSearch .> UC_SearchNotify : <<includes>>

UC_Login .> UC_LoginAttempts : <<includes>>

note right of UC_AdminSearch
  Only accessible by SUPER_ADMIN
  Can search across all tenants
  without tenant isolation
end note

note right of UC_GlobalSearch
  Automatically filtered by tenantId
  Uses Elasticsearch for fast search
  Supports caching with @Cacheable
end note

note bottom of UC_GenerateReport
  Service layer exists
  but controller is disabled
end note

note bottom of UC_CreateDashboard
  Service layer exists
  but controller is disabled
end note

@enduml
